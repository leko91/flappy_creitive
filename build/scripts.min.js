
var animate=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},worldWidth=600,worldHeight=400,canvas=document.createElement("canvas");canvas.width=worldWidth,canvas.height=worldHeight;var context=canvas.getContext("2d"),pipes=[],start=null,progress=0,pipeCounter=0,hasCrashed=!1,SPEED=2.4,GRAVITY=.75,FALL_SPEED=0,GAP=110,jumpSound=0,mute=!0,randomRGBColor1="rgb("+Math.round(256*Math.random())+", "+Math.round(256*Math.random())+", "+Math.round(256*Math.random())+")",randomRGBColor2="rgb("+Math.round(256*Math.random())+", "+Math.round(256*Math.random())+", "+Math.round(256*Math.random())+")",randomRGBColor3="rgb("+Math.round(256*Math.random())+", "+Math.round(256*Math.random())+", "+Math.round(256*Math.random())+")",score=0,realScore,stop=!1,scoreArray=["pittiful","solid","phenomenal"],scoreText,reset=function(){pipes=[],start=null,progress=0,pipeCounter=0,hasCrashed=!1,jumpSound=0,score=0,realScore=0,document.getElementsByClassName("js-score")[0].innerHTML=0,stop=!1,birdie.x=60,birdie.y=worldHeight/2-birdie.height,document.getElementsByClassName("js-ripScreen")[0].classList.add("is-hidden"),animate(step)},update=function(){for(var e=0;e<pipes.length;e++){if(birdie.crash(pipes[e]))return realScore=Math.floor(score/2),document.getElementsByClassName("js-ripScreen")[0].classList.remove("is-hidden"),scoreText=realScore<5?scoreArray[0]+" "+realScore:realScore>=15?scoreArray[2]+" "+realScore:scoreArray[1]+" "+realScore,document.getElementsByClassName("js-ripScreenScore")[0].innerText="Your score was a "+scoreText,void(stop=!0);pipes[e].x-=SPEED,birdie.score(pipes[e])&&(realScore=Math.floor(score/2),document.getElementsByClassName("js-score")[0].innerHTML=realScore)}birdie.update(),worldie.update()},render=function(){context.fillStyle=randomRGBColor1,context.fillRect(0,0,worldWidth,worldHeight),birdie.render();for(var e=0;e<pipes.length;e++)pipes[e].render()},step=function(e){update(),render(),progress++,stop||animate(step)},Bird=function(e,t,r,o){this.x=e,this.y=worldHeight/2-o,this.width=r,this.height=o};Bird.prototype.render=function(){var e=document.getElementsByClassName("js-image")[0];context.rect(this.x,this.y,this.width,this.height),context.drawImage(e,this.x,this.y)},Bird.prototype.update=function(){FALL_SPEED+=GRAVITY,FALL_SPEED*=.9,this.y+=FALL_SPEED},Bird.prototype.jump=function(e){FALL_SPEED+=e,this.y<-60&&(this.y=-60)},Bird.prototype.hitBottom=function(){if(this.y>worldHeight-this.height)return!0},Bird.prototype.crash=function(e){var t=this.x,r=this.x+this.width,o=this.y,i=this.y+this.height,n=e.x,s=e.x+e.width,a=e.y,d=e.y+e.height;return hasCrashed=!(i-5<a||o+5>d||r-5<n||t+5>s),this.hitBottom()&&(hasCrashed=!0),hasCrashed},Bird.prototype.score=function(e){var t=this.x,r=e.x;return Math.round(r)===t-Math.round(birdie.width/4)&&(score++,!0)};var World=function(e){this.gravity=e};World.prototype.update=function(){progress%Math.round(175/SPEED)===0&&this.createPipe()},World.prototype.createPipe=function(){topPipeHeight=Math.random()*(worldHeight-GAP)+10,pipes.push(new Pipe(worldWidth+40,(-60),40,topPipeHeight+60)),pipes.push(new Pipe(worldWidth+40,topPipeHeight+GAP,40,worldHeight-topPipeHeight-GAP))};var Pipe=function(e,t,r,o){this.x=e,this.y=t,this.width=r,this.height=o};Pipe.prototype.render=function(){context.beginPath(),context.fillStyle=randomRGBColor3,context.fillRect(this.x,this.y,this.width,this.height),context.fill()};var birdie=new Bird(60,10,30,30),worldie=new World(.3);$(window).on("keypress",function(e){var t=e.which||e.keyCode||0;32!==t||hasCrashed||(birdie.jump(-15),document.getElementsByClassName("js-help")[0].classList.add("is-hidden"),mute||document.getElementsByClassName("js-jumpSound")[jumpSound].play(),jumpSound++,4===jumpSound&&(jumpSound=0))}),$(window).on("touchstart",function(e){hasCrashed||(birdie.jump(-15),document.getElementsByClassName("js-help")[0].classList.add("is-hidden"),mute||document.getElementsByClassName("js-jumpSound")[jumpSound].play(),jumpSound++,4===jumpSound&&(jumpSound=0))}),$(window).on("keydown",function(e){var t=e.which||e.keyCode||0;82===t&&hasCrashed&&reset()}),document.getElementsByClassName("js-mute")[0].addEventListener("click",function(){mute?(this.innerHTML='mute <i class="fa fa-volume-up"></i>',mute=!1):(this.innerHTML='unmute <i class="fa fa-volume-off"></i>',mute=!0)});var displayScore=function(){document.getElementsByClassName("js-ripScreenScore")[0].append(score)};document.getElementsByClassName("js-tryAgain")[0].addEventListener("click",function(){reset()}),document.body.appendChild(canvas),animate(step);